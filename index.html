<!DOCTYPE html>
<html lang="ca">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" href="/lofi.png">
    <link rel="manifest" href="/manifest.json">
    <title>lofi moai</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sansita+Swashed:wght@900&display=block');

        @font-face {
            font-family: 'JetBrains Mono';
            src: url('https://cdn.jsdelivr.net/gh/JetBrains/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2') format('woff2'),
                url('https://cdn.jsdelivr.net/gh/JetBrains/JetBrainsMono/web/woff/JetBrainsMono-Regular.woff') format('woff');
            font-weight: 400;
            font-style: normal;
            font-display: block;
        }

        :root {
            --selected: #aaaaaa;
            --playing: #44dd88;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 400;
            user-select: none;
            background-color: #282c35;
            color: #eeeeee;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0px;
            padding: 0px;
        }

        #header {
            font-family: 'Sansita Swashed', cursive;
            font-weight: 900;
            font-size: 48pt;
            margin-bottom: 25px;
        }

        #radioList {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            text-align: center;
        }

        .radio-icon {
            width: 120px;
            height: 120px;
            margin: 12px;
            border-radius: 5px;
            cursor: pointer;
            user-drag: none;
            -webkit-user-drag: none;
            transition: transform 0.4s ease-in-out, box-shadow 0.2s ease-in-out;
        }

        .selected {
            box-shadow: 0 0 5px 3px var(--selected);
            transform: scale(1.2);
        }

        #selectedRadioName {
            font-size: 14pt;
            font-weight: 400;
            margin: 25px 0px;
        }

        audio {
            background-color: #282c35;
            margin-bottom: 10px;
        }
    </style>

</head>

<body>
    <div id="header">lofi moai</div>
    <div id="radioList"></div>
    <div id="selectedRadioName"></div>
    <audio controls id="radioPlayer">
        <source src="" type="audio/mp3">
        Your browser does not support the audio element.
    </audio>

    <script>
        const radioPlayer = document.getElementById('radioPlayer');
        const radioList = [
            {
                name: 'NIA Radio - Lofi',
                image: 'Radio-NIA.png',
                streamUrl: 'https://radio.nia.nc/radio/8020/lofi-hq-stream.aac'
            },
            {
                name: 'Chillsky.com',
                image: 'Radio-Chillsky.png',
                infoUrl: 'https://chillsky.com',
                streamUrl: 'https://lfhh.radioca.st/stream'
            },
            {
                name: 'Chillout Radio',
                image: 'Radio-chillout_ru.png',
                streamUrl: 'https://api.chilloutradio.ru:8040/live'
            },
            {
                name: 'BOX : Lofi Radio',
                image: 'Radio-boxlofi.png',
                streamUrl: 'https://boxradio-edge-05.streamafrica.net/lofi'
            },
            {
                name: 'freeCodeCamp.org Code Radio',
                image: 'Radio-FreeCodeCamp.png',
                streamUrl: 'https://coderadio-admin.freecodecamp.org/radio/8010/radio.mp3'
            },
            {
                name: '24/7 Lofi Radio',
                image: 'Radio-247Lofi.jpeg',
                streamUrl: 'https://ec3.yesstreaming.net:3755/stream'
            },
            {
                name: 'Sensual Lounge',
                image: 'Radio-SensualLounge.png',
                streamUrl: 'https://maggie.torontocast.com:8028/stream'
            },
            {
                name: 'Радио Рекорд Lo-Fi',
                image: 'Radio-RecordLofi.jpeg',
                streamUrl: 'https://radio.garden/api/ara/content/listen/z3aOLSzU/channel.mp3'
            },
            {
                name: 'NRJ - Lo-Fi',
                image: 'Radio-NRJ-LoFi.jpg',
                streamUrl: 'https://radio.garden/api/ara/content/listen/wYBoA74O/channel.mp3'
            },
            {
                name: 'bigFM LoFi Focus',
                image: 'Radio-BigFmLofi.jpg',
                streamUrl: 'https://audiotainment-sw.streamabc.net/atsw-lofifocus-mp3-128-3757575'
            },
            {
                name: 'Soma FM Lush',
                image: 'Radio-SomaLush.png',
                streamUrl: 'https://ice1.somafm.com/lush-128-mp3'
            },
            {
                name: "Dr Dick's Dub Shack",
                image: 'Radio-DubShack.png',
                streamUrl: 'http://radio.garden/api/ara/content/listen/mqdXmYNU/channel.mp3'
            }
            // Add other radio stations here
        ];

        // Retrieve the last selected radio index from localStorage
        const lastSelectedRadioIndex = localStorage.getItem('lastSelectedRadioIndex');
        //console.log('localStorage radio index:', lastSelectedRadioIndex);

        // Set the initial selected index to the last selected index or 0 if none is found
        const initialSelectedIndex = lastSelectedRadioIndex !== null ? parseInt(lastSelectedRadioIndex, 10) : 0;

        // Display the selected radio name
        const selectedRadioNameDiv = document.getElementById('selectedRadioName');

        let currentIndex = initialSelectedIndex;

        function changeChannel(index) {
            const icons = document.querySelectorAll('.radio-icon.selected');
            const isSelected = icons.length > 0;

            if (isSelected && !radioPlayer.paused) {
                pauseRadio();
            }

            icons.forEach((oldicon) => {
                oldicon.classList.remove('selected');
            });

            const newIndex = (index + radioList.length) % radioList.length;
            const newIcon = document.querySelectorAll('.radio-icon')[newIndex];
            newIcon.classList.add('selected');

            const selectedRadio = radioList[newIndex];
            selectedRadioNameDiv.textContent = selectedRadio.name;

            localStorage.setItem('lastSelectedRadioIndex', newIndex);

            radioPlayer.src = selectedRadio.streamUrl;
            playRadio();

            currentIndex = newIndex;
        }

        // Function to generate radio icons dynamically
        function generateRadioIcons() {
            const radioListDiv = document.getElementById('radioList');

            radioList.forEach((radio, index) => {
                const img = document.createElement('img');
                img.src = radio.image;
                img.alt = radio.name;
                img.title = radio.name;
                img.className = 'radio-icon';
                if (index === initialSelectedIndex) {
                    img.classList.add('selected');
                    selectedRadioNameDiv.textContent = radio.name;
                }
                img.onclick = () => changeChannel(index);
                radioListDiv.appendChild(img);
            });
        }

        // Play the initial channel when the page loads
        generateRadioIcons();

        // Agregar oyentes de eventos al reproductor de audioc
        radioPlayer.addEventListener('play', () => {
            // Cambiar el valor de la variable CSS para todos los radio-icon en radioList cuando se reproduce
            document.getElementById('radioList').style.setProperty('--selected', 'var(--playing)');
        });

        radioPlayer.addEventListener('pause', () => {
            // Restaurar el valor de la variable CSS para todos los radio-icon en radioList cuando se pausa
            document.getElementById('radioList').style.removeProperty('--selected');
        });

        radioPlayer.addEventListener('ended', () => {
            // Restaurar el valor de la variable CSS para todos los radio-icon en radioList cuando termina la reproducción
            document.getElementById('radioList').style.removeProperty('--selected');
        });

        document.addEventListener('keydown', function (event) {
            switch (event.key) {
                case ' ':
                    togglePlayPause();
                    break;
                case 'p':
                    pauseRadio();
                    break;
                case 'j':
                case 'ArrowLeft':
                    changeChannel(currentIndex - 1);
                    break;
                case 'k':
                case 'ArrowRight':
                    changeChannel(currentIndex + 1);
                    break;
            }
        });

        function togglePlayPause() {
            if (radioPlayer.paused) {
                playRadio();
            } else {
                pauseRadio();
            }
        }

        function playRadio() {
            radioPlayer.play();
        }

        function pauseRadio() {
            radioPlayer.pause();
        }

    </script>

</body>

</html>